{% extends "layout.html" %}
{% block body %}

<!-- header/nav bar with hamburger menu -->
<div data-role="page" id="menu-page" data-url="{{url_for('search')}}">
    <div data-role="header">
        <h1>Search</h1>
        <a href="#left-panel" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false">Menu</a> 
    </div><!-- /header -->

    <div class="ui-content">

      <form class="searchbox" method="POST" action={{"/search"}}>
        <input type="search" name="search" id="search-basic" value="" />
      </form>
      <div>
        {% if current_user.is_authenticated and not (current_user.is_anonymous()) %}
          Hi {{ current_user.username }} Search for food you'd like to cook!
          <div>
            Allergies: {{ current_user.allergies }} <br/>
            Restrictions: {{ current_user.restrictions }} <br/>
            Zipcode: {{ current_user.zipcode }} <br/>
            Time: {{ current_user.time }} <br/>
          <div>
        {% endif %}
      </div>

      {% if results %}
              <div id="results" role="content" class="ui-content">
                  {% for result in results %}
                         <a href={{'/recipe/'~ (result._id)}} data-transition="slide">
                            <div class = "container">
                               <div class = "resultsImage">
                                  <img src="{{result["photo"]["urls"][1]["url"]|string}}">
                               </div>

                               <div class = "resultsText">
                                  <h3><strong>{{result["title"]}}</strong></h3>
                                  <p>{{"Avg score: " +result["ratingAverage"]|string}}</p>
                               </div>
                               
                             <div class="plusSign">
                                  <a href="#add" data-rel="popup" class="ui-btn ui-btn-inline ui-corner-all ui-icon-plus"></a>
                                  <!-- <img class="plusImg" src="static/plusIcon.png"> -->

                                  <div data-role="popup" id="add" class="ui-content" style="min-width:250px;">
                               <!--    action="javascript:doSubmit();" -->
                                    <form method="POST" action={{"/search/add"}}>
                                      <div>
                                        <h3>Add recipe</h3>
                                        <input type="hidden" id=recipeName value={{result["title"]}} />
                                         <select name="meal" id="meal">
                                            <option value="breakfast">Breakfast</option>
                                            <option value="lunch">Lunch</option>
                                            <option value="dinner">Dinner</option>
                                         </select>
                                        <input type="date" id="date">
                                        <input type="submit" data-inline="true">
                                      </div>
                                    </form>
                                  </div> <!--popup-->

                                </div> <!--plusSign-->
                            </div> <!--container--> 
                          </a>

                  {% endfor %}
            </div> <!--results-->  
      {% endif %}

    </div><!-- /content -->

    <!-- hamburger menu contents -->
    <div data-role="panel" id="left-panel" class="noIcon">
      <!-- <img src="static/apple.png" id="logo"> -->
        <ul data-role="listview">
                 <li><a href="{{url_for('search')}}">Home</a></li>
                <li><a href="{{url_for('calendar')}}">Calendar</a></li>
                <li><a href="{{url_for('coupons')}}">Coupons</a></li>
                <li><a href="{{url_for('swipe')}}">Swipe</a></li>
                <li><a href="{{url_for('list')}}">Shopping List</a></li>
                <li><a href="{{url_for('preferences')}}">Preferences</a></li>
                <li><a href="{{url_for('help')}}">Help</a></li>
        </ul>
    </div><!-- /panel -->
</div>

{% endblock %}
